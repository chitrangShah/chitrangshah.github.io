<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="This post describes how to setup Glass Maps with Glass Mapper v4 in Sitecore using Castle Windsor.">
<meta name="keywords" content="sitecore,castle windsor,glass mapper,glass mapper v4,ioc,sitecore mvc,glass maps,glass configuration maps">
<meta property="og:type" content="article">
<meta property="og:title" content="Resolving Glass Configuration Maps in Glass Mapper v4 using Castle Windsor">
<meta property="og:url" content="https://chitrangshah.github.io/2015/11/10/resolving-glass-configuration-maps-in-glass-mapper-v4-castle-windsor/index.html">
<meta property="og:site_name" content="Chitrang Shah">
<meta property="og:description" content="This post describes how to setup Glass Maps with Glass Mapper v4 in Sitecore using Castle Windsor.">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2018-06-17T22:17:39.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Resolving Glass Configuration Maps in Glass Mapper v4 using Castle Windsor">
<meta name="twitter:description" content="This post describes how to setup Glass Maps with Glass Mapper v4 in Sitecore using Castle Windsor.">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>Resolving Glass Configuration Maps in Glass Mapper v4 using Castle Windsor</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="https://github.com/chitrangShah">Projects</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" href="/2014/03/13/static-blog-site-with-hexo-part-3/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://chitrangshah.github.io/2015/11/10/resolving-glass-configuration-maps-in-glass-mapper-v4-castle-windsor/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://chitrangshah.github.io/2015/11/10/resolving-glass-configuration-maps-in-glass-mapper-v4-castle-windsor/&text=Resolving Glass Configuration Maps in Glass Mapper v4 using Castle Windsor"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://chitrangshah.github.io/2015/11/10/resolving-glass-configuration-maps-in-glass-mapper-v4-castle-windsor/&title=Resolving Glass Configuration Maps in Glass Mapper v4 using Castle Windsor"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://chitrangshah.github.io/2015/11/10/resolving-glass-configuration-maps-in-glass-mapper-v4-castle-windsor/&is_video=false&description=Resolving Glass Configuration Maps in Glass Mapper v4 using Castle Windsor"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Resolving Glass Configuration Maps in Glass Mapper v4 using Castle Windsor&body=Check out this article: https://chitrangshah.github.io/2015/11/10/resolving-glass-configuration-maps-in-glass-mapper-v4-castle-windsor/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://chitrangshah.github.io/2015/11/10/resolving-glass-configuration-maps-in-glass-mapper-v4-castle-windsor/&title=Resolving Glass Configuration Maps in Glass Mapper v4 using Castle Windsor"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://chitrangshah.github.io/2015/11/10/resolving-glass-configuration-maps-in-glass-mapper-v4-castle-windsor/&title=Resolving Glass Configuration Maps in Glass Mapper v4 using Castle Windsor"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://chitrangshah.github.io/2015/11/10/resolving-glass-configuration-maps-in-glass-mapper-v4-castle-windsor/&title=Resolving Glass Configuration Maps in Glass Mapper v4 using Castle Windsor"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://chitrangshah.github.io/2015/11/10/resolving-glass-configuration-maps-in-glass-mapper-v4-castle-windsor/&title=Resolving Glass Configuration Maps in Glass Mapper v4 using Castle Windsor"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://chitrangshah.github.io/2015/11/10/resolving-glass-configuration-maps-in-glass-mapper-v4-castle-windsor/&name=Resolving Glass Configuration Maps in Glass Mapper v4 using Castle Windsor&description=&lt;p&gt;In one of my recent projects, we used the new version of &lt;a href=&#34;http://www.glass.lu/Blog/GlassV4&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Glass Mapper&lt;/a&gt;. One of the new features Glass has introduced is that of using Fluent Configuration API [&lt;em&gt;Glass Configuration Maps&lt;/em&gt;] which helps in keeping the POCO’s isolated and re-usable. Below is an example of how I am using it with &lt;a href=&#34;http://www.castleproject.org/projects/windsor/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Castle Windsor&lt;/a&gt;.&lt;/p&gt;"><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#V4-Glass-Map-POCO"><span class="toc-number">1.</span> <span class="toc-text">V4 Glass Map POCO</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#V3-POCO"><span class="toc-number">2.</span> <span class="toc-text">V3 POCO</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Resolving Glass Configuration Maps in Glass Mapper v4 using Castle Windsor
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Chitrang Shah</span>
      </span>
      
    <div class="postdate">
        <time datetime="2015-11-10T22:57:03.000Z" itemprop="datePublished">2015-11-10</time>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/castle-windsor/">castle windsor</a>, <a class="tag-link" href="/tags/glass-mapper/">glass mapper</a>, <a class="tag-link" href="/tags/glass-maps/">glass maps</a>, <a class="tag-link" href="/tags/sitecore/">sitecore</a>, <a class="tag-link" href="/tags/sitecore-mvc/">sitecore mvc</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>In one of my recent projects, we used the new version of <a href="http://www.glass.lu/Blog/GlassV4" target="_blank" rel="noopener">Glass Mapper</a>. One of the new features Glass has introduced is that of using Fluent Configuration API [<em>Glass Configuration Maps</em>] which helps in keeping the POCO’s isolated and re-usable. Below is an example of how I am using it with <a href="http://www.castleproject.org/projects/windsor/" target="_blank" rel="noopener">Castle Windsor</a>.</p>
<a id="more"></a>
<p>Here is a simple model that we will use for reference.</p>
<pre><code>public class TestPOCO
{
    public virtual string Title { get;set; }
    public virtual IEnumerable&lt;Item&gt; ListItems { get;set; }
    public virtual bool IsTestSite { get;set;}
}
</code></pre><p>Now, we will map it to Sitecore using the Glass Map feature. </p>
<h4 id="V4-Glass-Map-POCO"><a href="#V4-Glass-Map-POCO" class="headerlink" title="V4 Glass Map POCO"></a>V4 Glass Map POCO</h4><pre><code>public class TestPOCOConfig : SitecoreGlassMap&lt;TestPOCO&gt; //inherits &lt;IGlassMap&gt;
    {
        public override void Configure()
        {
            Map(
                x =&gt; x.AutoMap(),
                x =&gt;  x.Field(y =&gt;  y.Title).FieldName(&quot;Headline&quot;),
                x =&gt;  
                x.Field(y =&gt;  y.ListItems).FieldName(&quot;List Items&quot;).Setting(SitecoreFieldSettings.InferType),
                x =&gt;  x.Delegate(y =&gt;  y.IsTestSite).GetValue(y =&gt; IsTestSite())  
                //Delegate lets you call a method and use it&apos;s value...how cool is that!
                );
        }
    }    
</code></pre><p>The above configuration is similar to what was present in V3 but is much easier to read and manage IMO. </p>
<h4 id="V3-POCO"><a href="#V3-POCO" class="headerlink" title="V3 POCO"></a>V3 POCO</h4><pre><code>[SitecoreType(AutoMap =  true)]
public class TestPOCO
{
    [SitecoreField(&quot;Headline&quot;)]
    public virtual string Title { get; set; }

    [SitecoreField(&quot;List Items&quot;, Setting = SitecoreFieldSettings.InferType)]
    public virtual IEnumerable&lt;Item&gt; ListItems { get; set; }

    public virtual bool IsTestSite { get; set; }
}
</code></pre><p>Glass also added the new <code>Delegate</code> feature which is simply awesome as seen above! You can read more about it here <a href="http://cardinalcore.co.uk/2014/07/02/controlling-glass-fields-from-your-own-code/" target="_blank" rel="noopener">Glass Mapper Delegate</a>.</p>
<p>We have the original model and the Glass Map configuration for the model set up correctly for use. Now we need to register it so Glass can pick it up and Windsor can resolve it. </p>
<p>Below is how we would do it via the basic Glass Configuration in the <code>GlassMapperScCustom.cs</code> file.</p>
<pre><code>public static void AddMaps(IConfigFactory&lt;IGlassMap&gt; mapsConfigFactory)
{
     // Add maps here
      mapsConfigFactory.Add(() =&gt; new TestPOCOConfig());
}
</code></pre><p>Because we will be adding a bunch of models during development, we decided to resolve all of them via an IoC container such as Castle Windsor. You can use any of the IoC containers to do the same thing.<br><a href="http://www.palmmedia.de/blog/2011/8/30/ioc-container-benchmark-performance-comparison" target="_blank" rel="noopener">Check this for best IoC performer</a>.</p>
<p>I created a new class called <code>GlassMapConfigFactory.cs</code> which inherits from <code>IConfigFactory&lt;IGlassMap&gt;</code>. The below code scans through the assembly and registers all the classes which inherit <code>IGlassMap</code>.</p>
<pre><code>public class GlassMapConfigFactory : IConfigFactory&lt;IGlassMap&gt;
{
    public void Insert(int index, Func&lt;IGlassMap&gt; add)
    {
        throw new NotImplementedException();
    }

    public void Add(Func&lt;IGlassMap&gt; add)
    {
        throw new NotImplementedException();
    }

    public IEnumnerable&lt;IGlassMap&gt; GetItems()
    {
        IWindsorContainer container = new WindsorContainer();
        container.Register(Classes.FromThisAssembly().BasedOn&lt;IGlassMap&gt;().WithServiceBase());

        return container.ResolveAll&lt;IGlassMap&gt;();
    }
}
</code></pre><p>The last thing remaining to do is to tell Glass to pick this up in the <code>GlassMapperScCustom.cs</code> file. </p>
<pre><code>public static IDependencyResolver CreateResolver()
{
    var config = new Glass.Mapper.Sc.Config();

    var dependencyResolver = new DependencyResolver(config)
    {
        ConfigurationMapFactory = new GlassMapConfigFactory();
    };

    return dependencyResolver;
}
</code></pre><p>Comment this out</p>
<pre><code>public static void AddMaps(IConfigFactory&lt;IGlassMap&gt; mapsConfigFactory)
{
     // Add maps here
     //Resolved via Windsor
      //mapsConfigFactory.Add(() =&gt; new TestPOCOConfig());
}
</code></pre><p>That’s it! Now, if you rebuild your solution and re-load the page which uses the above model, it will still work as before without any issues. You will not have to touch the <code>GlassMapperScCustom.cs</code> again for configuring new models.</p>
<p>Have a look at the below posts as well from the author/creator of this feature:</p>
<p><a href="http://cardinalcore.co.uk/2015/09/03/life-through-a-lens-automatically-registering-glass-configuration-maps-using-a-container/" target="_blank" rel="noopener">Registering Glass Maps using a container</a></p>
<p><a href="http://cardinalcore.co.uk/2015/02/03/resolving-sitecore-controllers-from-your-ioc-container/" target="_blank" rel="noopener">Resolving Sitecore controllers using IoC</a></p>
<p>Let me know if you run into any issues or have any feedback. Cheers! :)</p>

  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="https://github.com/chitrangShah">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#V4-Glass-Map-POCO"><span class="toc-number">1.</span> <span class="toc-text">V4 Glass Map POCO</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#V3-POCO"><span class="toc-number">2.</span> <span class="toc-text">V3 POCO</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://chitrangshah.github.io/2015/11/10/resolving-glass-configuration-maps-in-glass-mapper-v4-castle-windsor/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://chitrangshah.github.io/2015/11/10/resolving-glass-configuration-maps-in-glass-mapper-v4-castle-windsor/&text=Resolving Glass Configuration Maps in Glass Mapper v4 using Castle Windsor"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://chitrangshah.github.io/2015/11/10/resolving-glass-configuration-maps-in-glass-mapper-v4-castle-windsor/&title=Resolving Glass Configuration Maps in Glass Mapper v4 using Castle Windsor"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://chitrangshah.github.io/2015/11/10/resolving-glass-configuration-maps-in-glass-mapper-v4-castle-windsor/&is_video=false&description=Resolving Glass Configuration Maps in Glass Mapper v4 using Castle Windsor"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Resolving Glass Configuration Maps in Glass Mapper v4 using Castle Windsor&body=Check out this article: https://chitrangshah.github.io/2015/11/10/resolving-glass-configuration-maps-in-glass-mapper-v4-castle-windsor/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://chitrangshah.github.io/2015/11/10/resolving-glass-configuration-maps-in-glass-mapper-v4-castle-windsor/&title=Resolving Glass Configuration Maps in Glass Mapper v4 using Castle Windsor"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://chitrangshah.github.io/2015/11/10/resolving-glass-configuration-maps-in-glass-mapper-v4-castle-windsor/&title=Resolving Glass Configuration Maps in Glass Mapper v4 using Castle Windsor"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://chitrangshah.github.io/2015/11/10/resolving-glass-configuration-maps-in-glass-mapper-v4-castle-windsor/&title=Resolving Glass Configuration Maps in Glass Mapper v4 using Castle Windsor"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://chitrangshah.github.io/2015/11/10/resolving-glass-configuration-maps-in-glass-mapper-v4-castle-windsor/&title=Resolving Glass Configuration Maps in Glass Mapper v4 using Castle Windsor"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://chitrangshah.github.io/2015/11/10/resolving-glass-configuration-maps-in-glass-mapper-v4-castle-windsor/&name=Resolving Glass Configuration Maps in Glass Mapper v4 using Castle Windsor&description=&lt;p&gt;In one of my recent projects, we used the new version of &lt;a href=&#34;http://www.glass.lu/Blog/GlassV4&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Glass Mapper&lt;/a&gt;. One of the new features Glass has introduced is that of using Fluent Configuration API [&lt;em&gt;Glass Configuration Maps&lt;/em&gt;] which helps in keeping the POCO’s isolated and re-usable. Below is an example of how I am using it with &lt;a href=&#34;http://www.castleproject.org/projects/windsor/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Castle Windsor&lt;/a&gt;.&lt;/p&gt;"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2018 Chitrang Shah
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="https://github.com/chitrangShah">Projects</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/fontawesome-all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-48362712-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Baidu Analytics -->

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'chitrangshah';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>


